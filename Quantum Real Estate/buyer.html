
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Buyer Portal</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
 
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }
 
    .container {
      background-color: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      width: 100%;
      max-width: 450px;
      padding: 40px;
      position: relative;
      animation: fadeIn 0.5s ease-in-out;
    }
 
    .close-btn {
      position: absolute;
      top: 15px;
      right: 15px;
      font-size: 24px;
      color: #888;
      cursor: pointer;
      transition: color 0.3s;
    }
 
    .close-btn:hover {
      color: #333;
    }
 
    h1 {
      text-align: center;
      margin-bottom: 30px;
      color: #333;
      font-weight: 600;
    }
 
    .form-group {
      margin-bottom: 25px;
      position: relative;
    }
 
    label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: #555;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
 
    input,
    textarea,
    select {
      width: 100%;
      padding: 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 16px;
      transition: all 0.3s;
      background-color: #f9f9f9;
    }
 
    input:focus,
    textarea:focus,
    select:focus {
      border-color: #667eea;
      outline: none;
      background-color: #fff;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.2);
    }
 
    button {
      width: 100%;
      padding: 15px;
      background: linear-gradient(to right, #667eea, #764ba2);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      margin-top: 10px;
    }
 
    button:hover {
      background: linear-gradient(to right, #5a6fd1, #6a4299);
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }
 
    .toggle-form {
      text-align: center;
      margin-top: 25px;
      color: #666;
      font-size: 14px;
    }
 
    .toggle-form a {
      color: #667eea;
      text-decoration: none;
      cursor: pointer;
      font-weight: 500;
    }
 
    .toggle-form a:hover {
      text-decoration: underline;
    }
 
    .error {
      color: #ff4757;
      font-size: 13px;
      margin-top: 5px;
      font-weight: 500;
    }
 
    .success {
      color: #2ed573;
      font-size: 14px;
      margin-top: 15px;
      text-align: center;
      font-weight: 500;
    }
 
    .hidden {
      display: none;
    }
 
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
 
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
 
    .floating-label {
      position: relative;
    }
 
    .floating-label label {
      position: absolute;
      top: 15px;
      left: 15px;
      color: #999;
      transition: all 0.3s;
      pointer-events: none;
      background-color: #f9f9f9;
      padding: 0 5px;
    }
 
    .floating-label input:focus+label,
    .floating-label input:not(:placeholder-shown)+label,
    .floating-label textarea:focus+label,
    .floating-label textarea:not(:placeholder-shown)+label,
    .floating-label select:focus+label,
    .floating-label select:not(:placeholder-shown)+label {
      top: -10px;
      left: 10px;
      font-size: 12px;
      color: #667eea;
      background-color: white;
    }
  </style>
 
</head>
<body>
  <div class="container">
    <div class="close-btn" id="close-btn">Ã—</div>
    <h1 id="form-title">Buyer Registration</h1>
 
    <div id="register-form">
      <!-- Registration form -->
      <div class="form-group floating-label">
        <input type="text" id="name" placeholder=" " />
        <label for="name">Full Name</label>
        <div id="name-error" class="error"></div>
      </div>
 
      <div class="form-group floating-label">
        <input type="email" id="email" placeholder=" " />
        <label for="email">Email</label>
        <div id="email-error" class="error"></div>
      </div>
 
      <div class="form-group floating-label">
        <input type="password" id="password" placeholder=" " />
        <label for="password">Password</label>
        <div id="password-error" class="error"></div>
      </div>
 
      <div class="form-group floating-label">
        <input type="tel" id="phoneNumber" placeholder=" " />
        <label for="phoneNumber">Phone Number</label>
        <div id="phoneNumber-error" class="error"></div>
      </div>
 
      <div class="form-group floating-label">
        <input type="url" id="profilePictureUrl" placeholder=" " />
        <label for="profilePictureUrl">Profile Picture URL</label>
        <div id="profilePictureUrl-error" class="error"></div>
      </div>
 
      <div class="form-group floating-label">
        <select id="role" required>
          <option value="" disabled selected></option>
          <option value="BUYER">Buyer</option>
        </select>
        <label for="role">Role</label>
        <div id="role-error" class="error"></div>
      </div>
 
      <button id="register-btn">Register</button>
      <div id="register-success" class="success hidden">Registration successful!</div>
 
      <div class="toggle-form">
        Already have an account? <a id="show-login">Login here</a>
      </div>
    </div>
 
    <div id="login-form" class="hidden">
      <!-- Login form -->
      <div class="form-group floating-label">
        <input type="email" id="login-email" placeholder=" " />
        <label for="login-email">Email</label>
        <div id="login-email-error" class="error"></div>
      </div>
 
      <div class="form-group floating-label">
        <input type="password" id="login-password" placeholder=" " />
        <label for="login-password">Password</label>
        <div id="login-password-error" class="error"></div>
      </div>
 
      <button id="login-btn">Login</button>
      <div id="login-success" class="success hidden">Login successful!</div>
 
      <div class="toggle-form">
        Don't have an account? <a id="show-register">Register here</a>
      </div>
    </div>
  </div>
 
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const registerForm = document.getElementById('register-form');
      const loginForm = document.getElementById('login-form');
      const showLogin = document.getElementById('show-login');
      const showRegister = document.getElementById('show-register');
      const formTitle = document.getElementById('form-title');
      const registerBtn = document.getElementById('register-btn');
      const loginBtn = document.getElementById('login-btn');
      const closeBtn = document.getElementById('close-btn');
 
      closeBtn.addEventListener('click', () => {
        document.querySelector('.container').style.animation = 'fadeIn 0.5s ease-in-out reverse';
        setTimeout(() => alert('Form closed. Refresh the page to reopen.'), 400);
      });
 
      showLogin.addEventListener('click', () => {
        registerForm.classList.add('hidden');
        loginForm.classList.remove('hidden');
        formTitle.textContent = 'Buyer Login';
      });
 
      showRegister.addEventListener('click', () => {
        loginForm.classList.add('hidden');
        registerForm.classList.remove('hidden');
        formTitle.textContent = 'Buyer Registration';
      });
 
      registerBtn.addEventListener('click', () => {
        if (validateRegisterForm()) registerUser();
      });
 
      loginBtn.addEventListener('click', () => {
        if (validateLoginForm()) loginUser();
      });
 
      function validateRegisterForm() {
        let isValid = true;
        const name = document.getElementById('name').value.trim();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value.trim();
        const phoneNumber = document.getElementById('phoneNumber').value.trim();
        const profilePictureUrl = document.getElementById('profilePictureUrl').value.trim();
        const role = document.getElementById('role').value;
 
        document.querySelectorAll('.error').forEach(el => el.textContent = '');
 
        if (!name) {
          document.getElementById('name-error').textContent = 'Name is required';
          isValid = false;
        }
 
        if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          document.getElementById('email-error').textContent = 'Valid email is required';
          isValid = false;
        }
 
        if (!password || password.length < 8) {
          document.getElementById('password-error').textContent = 'Minimum 8 characters';
          isValid = false;
        }
 
        if (!phoneNumber || !/^\d{10,}$/.test(phoneNumber)) {
          document.getElementById('phoneNumber-error').textContent = 'Valid phone number required';
          isValid = false;
        }
 
        if (profilePictureUrl && !/^https?:\/\/.+/.test(profilePictureUrl)) {
          document.getElementById('profilePictureUrl-error').textContent = 'Valid URL required';
          isValid = false;
        }
 
        if (!role) {
          document.getElementById('role-error').textContent = 'Role is required';
          isValid = false;
        }
 
        return isValid;
      }
 
      function validateLoginForm() {
        let isValid = true;
        const email = document.getElementById('login-email').value.trim();
        const password = document.getElementById('login-password').value.trim();
 
        document.getElementById('login-email-error').textContent = '';
        document.getElementById('login-password-error').textContent = '';
 
        if (!email || !/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email)) {
          document.getElementById('login-email-error').textContent = 'Valid email is required';
          isValid = false;
        }
 
        if (!password) {
          document.getElementById('login-password-error').textContent = 'Password is required';
          isValid = false;
        }
 
        return isValid;
      }
 
      function registerUser() {
        const userData = {
          name: document.getElementById('name').value.trim(),
          email: document.getElementById('email').value.trim(),
          password: document.getElementById('password').value.trim(),
          phoneNumber: document.getElementById('phoneNumber').value.trim(),
          profilePictureUrl: document.getElementById('profilePictureUrl').value.trim(),
          role: document.getElementById('role').value
        };
 
        fetch('http://localhost:8081/api/users/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(userData)
        })
        .then(response => response.ok ? response.json() : response.json().then(err => { throw err; }))
        .then(data => {
          document.getElementById('register-success').classList.remove('hidden');
          setTimeout(() => {
            registerForm.classList.add('hidden');
            loginForm.classList.remove('hidden');
            formTitle.textContent = 'Buyer Login';
            document.getElementById('register-success').classList.add('hidden');
            document.getElementById('login-email').value = userData.email;
          }, 1500);
        })
        .catch(error => {
          alert('Registration failed: ' + (error.message || 'Please try again.'));
        });
      }
 
      function loginUser() {
        const loginData = {
          email: document.getElementById('login-email').value.trim(),
          password: document.getElementById('login-password').value.trim()
        };
 
        fetch('http://localhost:8081/api/users/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(loginData)
        })
        .then(response => response.ok ? response.json() : response.json().then(err => { throw err; }))
        .then(data => {
          const token = data.token;
          if (token) {
            localStorage.setItem('authToken', token);
            document.getElementById('login-success').classList.remove('hidden');
            alert('Login successful! Token stored.');
            // Optionally redirect:
            // window.location.href = '/buyer-dashboard.html';
          } else {
            alert('Login succeeded, but token missing.');
          }
        })
        .catch(error => {
          alert('Login failed: ' + (error.message || 'Please try again.'));
        });
      }
 
      // Optional: Example function to use Bearer token for authorized requests
      function fetchProtectedData() {
        const token = localStorage.getItem('authToken');
        fetch('http://localhost:8081/api/protected', {
          headers: {
            'Authorization': 'Bearer ' + token
          }
        })
        .then(res => res.json())
        .then(data => console.log(data))
        .catch(err => console.error('Protected fetch failed:', err));
      }
 
    });
  </script>
</body>
</html>
 
 